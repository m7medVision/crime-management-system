\documentclass[a4paper,12pt]{article}

\usepackage[margin=2.5cm]{geometry}
\usepackage{fontspec}
\usepackage{graphicx}
\usepackage{enumitem}
\usepackage{hyperref}
\usepackage{xcolor}
\usepackage{booktabs}
\usepackage{longtable}
\usepackage{array}

\setmainfont[Mapping=tex-text]{Roboto}
\hypersetup{colorlinks=true, linkcolor=blue, urlcolor=blue}

\newcommand{\sectiontitle}[1]{
  \noindent\textbf{\large #1}
  \vspace{0.3cm}
}

\begin{document}

\begin{center}
  \textbf{\LARGE Case Report}
  \vspace{0.5cm}
  
  \textbf{\large Case \#{{.Case.CaseNumber}}}
  
  \textbf{\large {{.Case.Name}}}
  
  \vspace{0.5cm}
  Generated on {{.CreatedAt}}
\end{center}

\sectiontitle{Case Information}

\begin{tabular}{p{4cm}p{12cm}}
  \textbf{Case Number:} & {{.Case.CaseNumber}} \\
  \textbf{Status:} & {{.Case.Status}} \\
  \textbf{Area/City:} & {{.Case.Area}} \\
  \textbf{Case Type:} & {{.Case.CaseType}} \\
  \textbf{Created By:} & {{.Case.CreatedBy.FullName}} \\
  \textbf{Created At:} & {{.Case.CreatedAt.Format "January 2, 2006"}} \\
  \textbf{Authorization Level:} & {{.Case.AuthorizationLevel}} \\
\end{tabular}

\vspace{0.5cm}
\sectiontitle{Case Description}

{{.Case.Description}}

\vspace{0.8cm}
\sectiontitle{Evidence}

{{ if .Evidence }}
  {{ range $i, $e := .Evidence }}
    \textbf{Evidence \#{{$i}}}
    \begin{itemize}[leftmargin=*]
      \item \textbf{Type:} {{$e.Type}}
      \item \textbf{Added By:} {{$e.AddedBy.FullName}}
      \item \textbf{Added On:} {{$e.CreatedAt.Format "January 2, 2006"}}
      {{ if eq $e.Type "text" }}
      \item \textbf{Content:} {{$e.Content}}
      {{ else if eq $e.Type "image" }}
      \item \textbf{Image Path:} {{$e.ImagePath}}
      {{ end }}
      {{ if $e.Remarks }}
      \item \textbf{Remarks:} {{$e.Remarks}}
      {{ end }}
    \end{itemize}
    \vspace{0.3cm}
  {{ end }}
{{ else }}
  No evidence has been recorded for this case.
{{ end }}

\vspace{0.8cm}
\sectiontitle{Suspects}

{{ if .Suspects }}
  {{ range $i, $s := .Suspects }}
    \textbf{Suspect \#{{$i}}}
    \begin{itemize}[leftmargin=*]
      \item \textbf{Name:} {{$s.FirstName}} {{$s.LastName}}
      \item \textbf{Age:} {{$s.Age}}
      \item \textbf{Gender:} {{$s.Gender}}
      \item \textbf{Address:} {{$s.Address}}
      \item \textbf{Is Arrested:} {{if $s.IsArrested}}Yes{{else}}No{{end}}
      {{ if $s.Description }}
      \item \textbf{Description:} {{$s.Description}}
      {{ end }}
      {{ if $s.Notes }}
      \item \textbf{Notes:} {{$s.Notes}}
      {{ end }}
    \end{itemize}
    \vspace{0.3cm}
  {{ end }}
{{ else }}
  No suspects have been recorded for this case.
{{ end }}

\vspace{0.8cm}
\sectiontitle{Victims}

{{ if .Victims }}
  {{ range $i, $v := .Victims }}
    \textbf{Victim \#{{$i}}}
    \begin{itemize}[leftmargin=*]
      \item \textbf{Name:} {{$v.FirstName}} {{$v.LastName}}
      \item \textbf{Age:} {{$v.Age}}
      \item \textbf{Gender:} {{$v.Gender}}
      \item \textbf{Address:} {{$v.Address}}
      {{ if $v.InjuryDescription }}
      \item \textbf{Injury Description:} {{$v.InjuryDescription}}
      {{ end }}
      {{ if $v.Notes }}
      \item \textbf{Notes:} {{$v.Notes}}
      {{ end }}
    \end{itemize}
    \vspace{0.3cm}
  {{ end }}
{{ else }}
  No victims have been recorded for this case.
{{ end }}

\vspace{0.8cm}
\sectiontitle{Witnesses}

{{ if .Witnesses }}
  {{ range $i, $w := .Witnesses }}
    \textbf{Witness \#{{$i}}}
    \begin{itemize}[leftmargin=*]
      \item \textbf{Name:} {{$w.FirstName}} {{$w.LastName}}
      \item \textbf{Age:} {{$w.Age}}
      \item \textbf{Gender:} {{$w.Gender}}
      \item \textbf{Address:} {{$w.Address}}
      {{ if $w.Statement }}
      \item \textbf{Statement:} {{$w.Statement}}
      {{ end }}
      {{ if $w.Notes }}
      \item \textbf{Notes:} {{$w.Notes}}
      {{ end }}
    \end{itemize}
    \vspace{0.3cm}
  {{ end }}
{{ else }}
  No witnesses have been recorded for this case.
{{ end }}

\vspace{1cm}
\begin{center}
  \textit{This is an official report generated by the District Core Crime Management System.}\\
  \textit{Confidential document. Do not distribute without authorization.}
\end{center}

\end{document}
